<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA | CRYSTAL CINEMA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --glass: rgba(255, 255, 255, 0.05); --border: rgba(255, 255, 255, 0.12); }
        body { font-family: 'Outfit', sans-serif; background: #0a0b0d; color: #fff; overflow-x: hidden; }
        .frost-bg { background: var(--glass); backdrop-filter: blur(40px); border: 1px solid var(--border); }
        #player-overlay { position: fixed; inset: 0; z-index: 9999; display: none; background: #000; overflow-y: auto; }
        .player-viewport { width: 100%; height: 75vh; background: #000; }
        iframe { width: 100%; height: 100%; border: none; }
        .cast-grid { display: grid; grid-template-cols: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
        .cast-card { background: #141517; border-radius: 12px; overflow: hidden; }
        .cast-img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
    </style>
</head>
<body>

    <nav class="fixed top-0 w-full z-[100] p-6 flex justify-between items-center bg-gradient-to-b from-black to-transparent">
        <h1 class="text-2xl font-black italic tracking-tighter cursor-pointer" onclick="location.reload()">AURA</h1>
        <div class="flex gap-4">
             <button onclick="setMode('movie')" id="m-btn" class="px-5 py-2 rounded-full bg-white text-black font-bold text-[10px] uppercase">Movies</button>
             <button onclick="setMode('tv')" id="t-btn" class="px-5 py-2 rounded-full text-white/40 font-bold text-[10px] uppercase">TV</button>
        </div>
    </nav>

    <main class="pt-32 px-8">
        <div id="grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
    </main>

    <div id="player-overlay">
        <div class="p-4 flex justify-between items-center bg-[#0a0b0d]">
            <button onclick="closePlayer()" class="px-6 py-2 frost-bg rounded-lg text-[10px] font-bold uppercase">← Back</button>
            <div class="flex gap-2">
                <button id="external-link" class="px-6 py-2 bg-blue-600 rounded-lg text-[10px] font-bold uppercase">Open Source Directly</button>
                <select id="srv-select" onchange="updPlayer()" class="bg-white/10 p-2 rounded text-[10px] font-bold uppercase outline-none">
                    <option value="cinemaos">CinemaOS (Primary)</option>
                    <option value="vidsrcto">VidSrc TO</option>
                    <option value="vidsrcme">VidSrc ME</option>
                </select>
            </div>
        </div>
        
        <div class="player-viewport">
            <iframe id="frame" src="" allowfullscreen allow="autoplay; encrypted-media; picture-in-picture"></iframe>
        </div>

        <div class="p-8 max-w-6xl mx-auto">
            <h2 id="modal-title" class="text-4xl font-black uppercase italic mb-2"></h2>
            <div id="modal-meta" class="flex gap-3 text-[10px] font-bold opacity-40 uppercase mb-6"></div>
            <p id="modal-desc" class="text-sm opacity-60 leading-relaxed mb-10"></p>
            
            <h3 class="text-[10px] font-black uppercase tracking-widest opacity-30 mb-6">Full Cast</h3>
            <div id="cast-list" class="cast-grid pb-20"></div>
        </div>
    </div>

    <script>
        const KEY = 'a45420333457411e78d5ad35d6c51a2d';
        let mode = 'movie', activeID = null;

        async function init() {
            const r = await fetch(`https://api.themoviedb.org/3/trending/${mode}/week?api_key=${KEY}`);
            const d = await r.json();
            document.getElementById('grid').innerHTML = d.results.map(m => `
                <div class="cursor-pointer hover:scale-105 transition" onclick="openPlayer(${m.id})">
                    <img src="https://image.tmdb.org/t/p/w500${m.poster_path}" class="rounded-xl">
                </div>`).join('');
        }

        async function openPlayer(id) {
            activeID = id;
            document.getElementById('player-overlay').style.display = 'block';
            
            const info = await fetch(`https://api.themoviedb.org/3/${mode}/${id}?api_key=${KEY}`).then(r => r.json());
            document.getElementById('modal-title').innerText = info.title || info.name;
            document.getElementById('modal-desc').innerText = info.overview;
            document.getElementById('modal-meta').innerHTML = `<span>${(info.release_date || info.first_air_date).split('-')[0]}</span><span>•</span><span>${info.genres.map(g => g.name).join(' / ')}</span>`;

            const cr = await fetch(`https://api.themoviedb.org/3/${mode}/${id}/credits?api_key=${KEY}`).then(r => r.json());
            document.getElementById('cast-list').innerHTML = cr.cast.map(c => `
                <div class="cast-card">
                    <img class="cast-img" src="${c.profile_path ? 'https://image.tmdb.org/t/p/w300'+c.profile_path : 'https://via.placeholder.com/300x450?text=No+Photo'}">
                    <div class="p-3">
                        <p class="text-[10px] font-bold uppercase leading-tight">${c.name}</p>
                        <p class="text-[8px] opacity-40 uppercase mt-1">${c.character}</p>
                    </div>
                </div>`).join('');

            updPlayer();
        }

        function updPlayer() {
            const srv = document.getElementById('srv-select').value;
            let url = "";
            if(srv === 'cinemaos') url = `https://cinemaos.tech/embed/${mode}/${activeID}`;
            if(srv === 'vidsrcto') url = `https://vidsrc.to/embed/${mode}/${activeID}`;
            if(srv === 'vidsrcme') url = `https://vidsrc.me/embed/${mode}?tmdb=${activeID}`;
            
            document.getElementById('frame').src = url;
            document.getElementById('external-link').onclick = () => window.open(url, '_blank');
        }

        function closePlayer() {
            document.getElementById('player-overlay').style.display = 'none';
            document.getElementById('frame').src = '';
        }

        function setMode(m) {
            mode = m;
            document.getElementById('m-btn').className = m === 'movie' ? 'px-5 py-2 rounded-full bg-white text-black font-bold text-[10px] uppercase' : 'px-5 py-2 rounded-full text-white/40 font-bold text-[10px] uppercase';
            document.getElementById('t-btn').className = m === 'tv' ? 'px-5 py-2 rounded-full bg-white text-black font-bold text-[10px] uppercase' : 'px-5 py-2 rounded-full text-white/40 font-bold text-[10px] uppercase';
            init();
        }

        init();
    </script>
</body>
</html>
