<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROTOCOL | MEDIA INTERFACE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --crimson: #ff003c; --void: #050507; --panel: #0d0e12; }
        body { font-family: 'Space Grotesk', sans-serif; background: var(--void); color: white; overflow-x: hidden; }
        
        /* Sidebar Nav */
        .sidebar { background: var(--panel); border-right: 1px solid rgba(0, 242, 255, 0.1); z-index: 100; }
        .nav-link { transition: 0.3s; position: relative; }
        .nav-link.active { color: var(--neon); }
        .nav-link.active::before { content: ''; position: absolute; left: -24px; height: 100%; width: 4px; background: var(--neon); box-shadow: 0 0 15px var(--neon); }

        /* Futuro Cards */
        .card-frame { 
            position: relative; overflow: hidden; border-radius: 4px; 
            clip-path: polygon(0 0, 100% 0, 100% 90%, 90% 100%, 0 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: 0.4s cubic-bezier(0.2, 1, 0.2, 1);
        }
        .card-frame:hover { transform: translateY(-5px); border-color: var(--neon); box-shadow: 0 0 30px rgba(0, 242, 255, 0.2); }
        .card-meta { background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); }

        /* Cinematic Theatre Modal */
        #theatre-modal { background: rgba(2, 2, 4, 0.98); backdrop-filter: blur(20px); display: none; }
        .theatre-viewport { 
            width: 100%; aspect-ratio: 21 / 9; background: #000; 
            box-shadow: 0 0 100px rgba(0, 242, 255, 0.1);
            border: 1px solid rgba(0, 242, 255, 0.2);
        }

        /* Scanline Effect */
        .scanlines::after {
            content: " "; display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 118, 0.06));
            z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }

        /* Custom Dropdowns */
        .drop-zone { background: #16181d; border: 1px solid #2a2d35; border-radius: 4px; cursor: pointer; }
        .drop-menu { background: #16181d; border: 1px solid #2a2d35; display: none; position: absolute; width: 100%; z-index: 50; }
        .drop-zone:hover .drop-menu { display: block; }
        
        .no-scroll { overflow: hidden; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--neon); }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="sidebar fixed h-screen w-20 lg:w-64 flex flex-col items-center lg:items-start p-6">
        <div class="mb-12">
            <h1 class="hidden lg:block text-2xl font-bold tracking-tighter text-white">OPBOI <span class="text-[#00f2ff]">PRTCL</span></h1>
            <div class="lg:hidden w-10 h-10 bg-[#00f2ff] rounded-sm"></div>
        </div>

        <nav class="flex-1 space-y-8">
            <div class="space-y-4">
                <p class="hidden lg:block text-[10px] uppercase tracking-[0.3em] text-gray-500 font-bold">Library</p>
                <button onclick="setMode('movie')" id="nav-movie" class="nav-link active flex items-center gap-4 text-sm font-medium">
                    <span class="p-2 bg-white/5 rounded">MV</span> <span class="hidden lg:block">Cinema Core</span>
                </button>
                <button onclick="setMode('tv')" id="nav-tv" class="nav-link flex items-center gap-4 text-sm font-medium text-gray-400">
                    <span class="p-2 bg-white/5 rounded">TV</span> <span class="hidden lg:block">Serial Feed</span>
                </button>
            </div>
            
            <div class="space-y-4">
                <p class="hidden lg:block text-[10px] uppercase tracking-[0.3em] text-gray-500 font-bold">Sort</p>
                <select id="genre-filter" onchange="runGenre()" class="bg-transparent border-none text-xs font-bold text-[#00f2ff] outline-none w-full cursor-pointer"></select>
            </div>
        </nav>

        <div class="mt-auto w-full">
            <input type="text" id="search-bar" placeholder="SEARCH_" class="w-full bg-white/5 border border-white/10 p-3 text-xs outline-none focus:border-[#00f2ff] transition">
        </div>
    </aside>

    <main class="ml-20 lg:ml-64 flex-1 p-8 lg:p-12">
        <header id="hero-unit" class="relative h-[60vh] mb-16 group rounded-sm overflow-hidden border border-white/5">
            <div id="hero-bg" class="absolute inset-0 bg-cover bg-center scanlines grayscale hover:grayscale-0 transition-all duration-1000"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div>
            
            <div class="absolute bottom-12 left-12 max-w-3xl">
                <div class="flex items-center gap-3 mb-4">
                    <span class="w-2 h-2 bg-[#00f2ff] animate-pulse"></span>
                    <span class="text-[10px] tracking-[0.5em] uppercase text-[#00f2ff]">Data Fragment Identified</span>
                </div>
                <h2 id="hero-title" class="text-6xl lg:text-8xl font-bold mb-6 tracking-tighter uppercase italic">PROTOCOL_LOAD</h2>
                <p id="hero-desc" class="text-gray-400 text-sm leading-relaxed mb-8 line-clamp-2 font-light"></p>
                <button id="hero-play" class="bg-[#00f2ff] text-black px-10 py-4 text-xs font-bold uppercase tracking-widest hover:bg-white transition-all">Execute Stream</button>
            </div>
        </header>

        <section>
            <div class="flex items-center justify-between mb-10">
                <h3 class="text-xs font-bold tracking-[0.4em] uppercase text-gray-500 italic">Retrieved Entities</h3>
                <div class="h-[1px] flex-1 mx-8 bg-white/5"></div>
            </div>
            <div id="main-grid" class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-6"></div>
        </section>
    </main>

    <div id="theatre-modal" class="fixed inset-0 z-[200] overflow-y-auto p-4 lg:p-12">
        <div class="max-w-[1600px] mx-auto">
            <div class="flex items-center justify-between mb-8">
                <button onclick="closeTheatre()" class="text-[#ff003c] text-[10px] font-bold tracking-[0.4em] uppercase border border-[#ff003c]/30 px-6 py-2 hover:bg-[#ff003c] hover:text-white transition">Terminate_Session</button>
                
                <div class="flex gap-4">
                    <div class="drop-zone relative px-6 py-3 min-w-[180px]">
                        <span class="text-[10px] font-bold uppercase tracking-widest text-[#00f2ff]">Srv: <span id="active-srv">CinemaOS</span></span>
                        <div class="drop-menu p-2 space-y-1" id="srv-options"></div>
                    </div>
                    
                    <div id="tv-meta" class="hidden flex gap-4">
                        <div class="drop-zone relative px-6 py-3"><span class="text-[10px] font-bold uppercase">S: <span id="s-val">1</span></span><div id="s-menu" class="drop-menu p-2 max-h-48 overflow-y-auto"></div></div>
                        <div class="drop-zone relative px-6 py-3"><span class="text-[10px] font-bold uppercase">E: <span id="e-val">1</span></span><div id="e-menu" class="drop-menu p-2 max-h-48 overflow-y-auto"></div></div>
                    </div>
                </div>
            </div>

            <div class="theatre-viewport mb-12"><iframe id="stream-frame" src="" allowfullscreen></iframe></div>

            <div class="grid lg:grid-cols-4 gap-8">
                <div class="lg:col-span-3 bg-[#0d0e12] p-10 border-l-2 border-[#00f2ff]">
                    <div class="flex items-center gap-6 mb-8 text-[#00f2ff]">
                        <span id="p-year" class="text-2xl font-bold">2026</span>
                        <div id="p-tags" class="flex gap-2"></div>
                    </div>
                    <h2 id="p-title" class="text-6xl font-bold mb-8 uppercase tracking-tighter italic">Title</h2>
                    <p id="p-desc" class="text-gray-500 text-lg leading-relaxed font-light"></p>
                </div>
                
                <div class="bg-[#0d0e12] p-10 border-r-2 border-[#ff003c]">
                    <p class="text-[10px] uppercase tracking-[0.3em] text-[#ff003c] mb-10 text-center">Cast Identified</p>
                    <div id="p-cast" class="grid grid-cols-2 gap-6"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const KEY = 'a45420333457411e78d5ad35d6c51a2d';
        let mode = 'movie', activeId = null, srv = 'cinemaos', s = 1, e = 1;
        
        const nodes = [
            {id:'cinemaos', n:'CinemaOS'}, {id:'vidsrcto', n:'Protocol-2'},
            {id:'vidsrcme', n:'Stable-X'}, {id:'vidsrccc', n:'Direct-Link'}, {id:'embedsu', n:'Ultra-Node'}
        ];

        async function init(q = '', g = '') {
            let url = `https://api.themoviedb.org/3/trending/${mode}/week?api_key=${KEY}`;
            if(q) url = `https://api.themoviedb.org/3/search/${mode}?api_key=${KEY}&query=${q}`;
            if(g) url = `https://api.themoviedb.org/3/discover/${mode}?api_key=${KEY}&with_genres=${g}`;
            
            const res = await fetch(url);
            const data = await res.json();
            if(!q && !g && data.results[0]) setupHero(data.results[0]);
            renderGrid(data.results);
            fetchGenres();
        }

        async function fetchGenres() {
            const res = await fetch(`https://api.themoviedb.org/3/genre/${mode}/list?api_key=${KEY}`);
            const data = await res.json();
            document.getElementById('genre-filter').innerHTML = `<option value="">ALL_PROTOCOLS</option>` + 
                data.genres.map(g => `<option value="${g.id}">${g.name.toUpperCase()}</option>`).join('');
        }

        function setupHero(m) {
            document.getElementById('hero-bg').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
            document.getElementById('hero-title').innerText = m.title || m.name;
            document.getElementById('hero-desc').innerText = m.overview;
            document.getElementById('hero-play').onclick = () => openTheatre(m.id, m.title || m.name);
        }

        function renderGrid(items) {
            document.getElementById('main-grid').innerHTML = items.map(m => !m.poster_path ? '' : `
                <div class="card-frame group cursor-pointer" onclick="openTheatre(${m.id}, '${(m.title||m.name).replace(/'/g,"\\")}')">
                    <img src="https://image.tmdb.org/t/p/w500${m.poster_path}" class="w-full grayscale group-hover:grayscale-0 transition-all duration-500">
                    <div class="card-meta absolute inset-0 flex flex-col justify-end p-4">
                        <h4 class="font-bold text-[10px] uppercase tracking-widest mb-1">${m.title || m.name}</h4>
                        <div class="h-0.5 w-0 group-hover:w-full bg-[#00f2ff] transition-all"></div>
                    </div>
                </div>`).join('');
        }

        async function openTheatre(id, title) {
            activeId = id; s = 1; e = 1;
            document.getElementById('p-title').innerText = title;
            document.getElementById('theatre-modal').style.display = 'block';
            document.body.classList.add('no-scroll');
            
            const d = await fetch(`https://api.themoviedb.org/3/${mode}/${id}?api_key=${KEY}&append_to_response=credits`).then(r => r.json());
            document.getElementById('p-desc').innerText = d.overview;
            document.getElementById('p-year').innerText = (d.release_date || d.first_air_date || '2026').split('-')[0];
            document.getElementById('p-tags').innerHTML = d.genres.map(g => `<span class="text-[9px] border border-[#00f2ff]/30 px-3 py-1 font-bold">${g.name.toUpperCase()}</span>`).join('');
            
            document.getElementById('p-cast').innerHTML = d.credits.cast.slice(0, 4).map(c => `
                <div class="text-center">
                    <img src="${c.profile_path ? 'https://image.tmdb.org/t/p/w185' + c.profile_path : 'https://via.placeholder.com/185x185'}" class="w-12 h-12 rounded-full mx-auto mb-2 grayscale">
                    <p class="text-[8px] font-bold uppercase text-gray-500">${c.name.split(' ')[0]}</p>
                </div>`).join('');

            document.getElementById('srv-options').innerHTML = nodes.map(n => `<button onclick="setNode('${n.id}', '${n.n}')" class="w-full text-left p-2 hover:bg-[#00f2ff] hover:text-black text-[9px] font-bold uppercase">${n.n}</button>`).join('');

            if (mode === 'tv') {
                document.getElementById('tv-meta').classList.remove('hidden');
                document.getElementById('s-menu').innerHTML = d.seasons.filter(sea => sea.season_number > 0).map(sea => `<button onclick="setS(${sea.season_number})" class="w-full text-left p-2 hover:bg-[#00f2ff] hover:text-black text-[9px] font-bold uppercase">SEA_${sea.season_number}</button>`).join('');
                loadEpisodes();
            } else {
                document.getElementById('tv-meta').classList.add('hidden');
                updateFrame();
            }
        }

        async function loadEpisodes() {
            const data = await fetch(`https://api.themoviedb.org/3/tv/${activeId}/season/${s}?api_key=${KEY}`).then(r => r.json());
            document.getElementById('e-menu').innerHTML = data.episodes.map(eps => `<button onclick="setE(${eps.episode_number})" class="w-full text-left p-2 hover:bg-[#00f2ff] hover:text-black text-[9px] font-bold uppercase truncate">EP_${eps.episode_number}</button>`).join('');
            updateFrame();
        }

        function setNode(id, n) { srv = id; document.getElementById('active-srv').innerText = n; updateFrame(); }
        function setS(val) { s = val; e = 1; document.getElementById('s-val').innerText = val; loadEpisodes(); }
        function setE(val) { e = val; document.getElementById('e-val').innerText = val; updateFrame(); }
        function runGenre() { init('', document.getElementById('genre-filter').value); }
        
        function updateFrame() {
            let src = '';
            if(mode === 'movie') {
                if(srv==='cinemaos') src=`https://cinemaos.tech/player/${activeId}`;
                else if(srv==='vidsrcto') src=`https://vidsrc.to/embed/movie/${activeId}`;
                else if(srv==='vidsrcme') src=`https://vidsrc.me/embed/movie?tmdb=${activeId}`;
                else if(srv==='vidsrccc') src=`https://vidsrc.cc/v2/embed/movie/${activeId}`;
                else src=`https://embed.su/embed/movie/${activeId}`;
            } else {
                if(srv==='cinemaos') src=`https://cinemaos.tech/player/${activeId}/${s}/${e}`;
                else if(srv==='vidsrcto') src=`https://vidsrc.to/embed/tv/${activeId}/${s}/${e}`;
                else if(srv==='vidsrcme') src=`https://vidsrc.me/embed/tv?tmdb=${activeId}&sea=${s}&epi=${e}`;
                else if(srv==='vidsrccc') src=`https://vidsrc.cc/v2/embed/tv/${activeId}/${s}/${e}`;
                else src=`https://embed.su/embed/tv/${activeId}/${s}/${e}`;
            }
            document.getElementById('stream-frame').src = src;
        }

        function closeTheatre() { document.getElementById('theatre-modal').style.display='none'; document.getElementById('stream-frame').src=''; document.body.classList.remove('no-scroll'); }
        function setMode(m) { 
            mode = m; 
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById(`nav-${m}`).classList.add('active');
            init(); 
        }
        document.getElementById('search-bar').addEventListener('input', e => { if(e.target.value.length > 2) init(e.target.value); });
        init();
    </script>
</body>
</html>
